<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Product list</title>
</head>
<body>
<div th:insert="~{fragments.html :: header}"></div>

<table border="1" align="center" width="100%">
    <tr>
        <th>
            <span th:text="#{title}">Title</span>
        </th>
        <th>
            <span th:text="#{price}">Price</span>
        </th>
        <td>
            <span th:text="#{image}">Image</span>
        </td>
    </tr>
    <tr th:each="product : ${products}">
        <td th:text="${product.title}">Cheese</td>
        <td th:text="${product.price}">12.0</td>
        <td>
            <div th:if="${product.image}">
                <img width="40" height="40" th:src="@{/api/v1/products/{id}/avatar(id=${product.id})}">
            </div>
        </td>
        <td sec:authorize="hasAnyAuthority('USER')"><a th:href="@{/products/{id}/bucket(id=${product.id})}">
            <span th:text="#{bucket.add}">Add to bucket</span>
        </a></td>
    </tr>
    <form sec:authorize="hasAnyAuthority('ADMIN')" th:action="@{/products}" method="post" enctype="multipart/form-data">
        <td><input type="text" name="title"></td>
        <td><input type="number" name="price"></td>
        <td>
            <input id="image" type="file" name="image">
        </td>
        <td>
            <button type="submit">
                <span th:text="#{create}">Create</span>
            </button>
        </td>
    </form>
</table>
</body>
</html>